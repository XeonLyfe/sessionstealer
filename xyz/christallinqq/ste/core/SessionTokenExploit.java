package xyz.christallinqq.ste.core;

import java.util.UUID;
import net.minecraft.util.Session;
import java.util.Arrays;
import net.minecraft.client.Minecraft;
import java.lang.reflect.Field;

public class SessionTokenExploit
{
    public static void setNewSession() {
        try {
            final Field session = Arrays.stream(Minecraft.class.getDeclaredFields()).filter(f -> f.getType() == Session.class).findFirst().get();
            session.setAccessible(true);
            session.set(Minecraft.func_71410_x(), new Session("Janrupf", getIdFromString("cb3f34da-cd1a-420c-8616-655204b5e004").toString(), Minecraft.func_71410_x().func_110432_I().func_148254_d(), "mojang"));
        }
        catch (Throwable t) {
            throw new RuntimeException(t);
        }
    }
    
    private static UUID getIdFromString(final String uuid) {
        if (uuid.contains("-")) {
            return UUID.fromString(uuid);
        }
        return UUID.fromString(uuid.replaceFirst("(\\p{XDigit}{8})(\\p{XDigit}{4})(\\p{XDigit}{4})(\\p{XDigit}{4})(\\p{XDigit}+)", "$1-$2-$3-$4-$5"));
    }
}
